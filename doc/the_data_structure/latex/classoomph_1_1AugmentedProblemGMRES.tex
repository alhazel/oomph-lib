\hypertarget{classoomph_1_1AugmentedProblemGMRES}{}\doxysection{oomph\+::Augmented\+Problem\+GMRES Class Reference}
\label{classoomph_1_1AugmentedProblemGMRES}\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}


//////////////////////////////////////////////////////////////////// ////////////////////////////////////////////////////////////////////  




{\ttfamily \#include $<$iterative\+\_\+linear\+\_\+solver.\+h$>$}

Inheritance diagram for oomph\+::Augmented\+Problem\+GMRES\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=4.000000cm]{classoomph_1_1AugmentedProblemGMRES}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a04987cc3a1440855435d2c26cfbfc0bf}{Augmented\+Problem\+GMRES}} (\mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} $\ast$b\+\_\+pt, \mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} $\ast$c\+\_\+pt, double $\ast$x\+\_\+pt, double $\ast$rhs\+\_\+pt)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
virtual \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_ab2593fd534e6db559b93c1301306c69b}{$\sim$\+Augmented\+Problem\+GMRES}} ()
\begin{DoxyCompactList}\small\item\em Destructor\+: Clean up storage. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a5c19aa1ff1b23b8400f1e81b29f7e7de}{Augmented\+Problem\+GMRES}} (const \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES}{Augmented\+Problem\+GMRES}} \&)=delete
\begin{DoxyCompactList}\small\item\em Broken copy constructor. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_aa59dc0dfad8c26eeba778dde0cdc0d8d}{operator=}} (const \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES}{Augmented\+Problem\+GMRES}} \&)=delete
\begin{DoxyCompactList}\small\item\em Broken assignment operator. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a338c1108f68089ba78104a93ec2cbbca}{disable\+\_\+resolve}} ()
\begin{DoxyCompactList}\small\item\em Overload disable resolve so that it cleans up memory too. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a73d8d3d8b161084e6291560cdd7984dc}{solve}} (\mbox{\hyperlink{classoomph_1_1Problem}{Problem}} $\ast$const \&problem\+\_\+pt, \mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} \&result)
\begin{DoxyCompactList}\small\item\em Solver\+: Takes pointer to problem and returns the results vector which contains the solution of the linear system defined by the problem\textquotesingle{}s fully assembled Jacobian and residual vector. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a0e7809509296cc1b6d355a7e02d0f989}{solve}} (\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase}{Double\+Matrix\+Base}} $\ast$const \&matrix\+\_\+pt, const \mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} \&rhs, \mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} \&solution)
\begin{DoxyCompactList}\small\item\em Linear-\/algebra-\/type solver\+: Takes pointer to a matrix and rhs vector and returns the solution of the linear system. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a6dc70380e15f0c35f3d4e1d3dc827c97}{solve}} (\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase}{Double\+Matrix\+Base}} $\ast$const \&matrix\+\_\+pt, const \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$ \&rhs, \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$ \&result)
\begin{DoxyCompactList}\small\item\em Linear-\/algebra-\/type solver\+: Takes pointer to a matrix and rhs vector and returns the solution of the linear system Call the broken base-\/class version. If you want this, please implement it. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a2a452417f612f30e3ae2a2701fa1e6de}{resolve}} (const \mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} \&rhs, \mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} \&result)
\begin{DoxyCompactList}\small\item\em Re-\/solve the system defined by the last assembled Jacobian and the rhs vector specified here. Solution is returned in the vector result. \end{DoxyCompactList}\item 
unsigned \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a0e6fb26306985fc6bde851d372b78708}{iterations}} () const
\begin{DoxyCompactList}\small\item\em Number of iterations taken. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a5e3a50ebf6ce2d2c3a0a53b7e6f24300}{iteration\+\_\+restart}} () const
\begin{DoxyCompactList}\small\item\em access function indicating whether restarted \mbox{\hyperlink{classoomph_1_1GMRES}{GMRES}} is used \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a7baee709b4066c7e3dce35afe76a0792}{enable\+\_\+iteration\+\_\+restart}} (const unsigned \&restart)
\begin{DoxyCompactList}\small\item\em switches on iteration restarting and takes as an argument the number of iterations after which the construction of the orthogonalisation basis vectors should be restarted \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a478992300f83afa08cde46ac11569986}{disable\+\_\+iteration\+\_\+restart}} ()
\begin{DoxyCompactList}\small\item\em Switches off iteration restart. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_ae29f07a20c4e1290ae1c85f4c5756adc}{set\+\_\+preconditioner\+\_\+\+LHS}} ()
\begin{DoxyCompactList}\small\item\em Set left preconditioning (the default) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_ab9349ea974f4e84d4ae3d7de096e60bd}{set\+\_\+preconditioner\+\_\+\+RHS}} ()
\begin{DoxyCompactList}\small\item\em Enable right preconditioning. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_aa4fbf2fd3d7ce466e7ea74620c4bdcea}{clean\+\_\+up\+\_\+memory}} ()
\begin{DoxyCompactList}\small\item\em Cleanup data that\textquotesingle{}s stored for resolve (if any has been stored) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a98bde93ede0909eb0170ef490c6d184d}{augmented\+\_\+matrix\+\_\+multiply}} (\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} $\ast$matrix\+\_\+pt, const \mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} \&x, \mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} \&soln)
\begin{DoxyCompactList}\small\item\em Multiply the vector x by the augmented system matrix. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a71199dc59da3f5077803829e36ad4aec}{apply\+\_\+schur\+\_\+complement\+\_\+preconditioner}} (const \mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} \&rhs, \mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} \&soln)
\begin{DoxyCompactList}\small\item\em Apply the block-\/diagonal Schur complement preconditioner to compute the LHS which has size N+1 (the augmented system size) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a1ff5a4b43235b43d2254af0db6195dc7}{solve\+\_\+helper}} (\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase}{Double\+Matrix\+Base}} $\ast$const \&matrix\+\_\+pt, const \mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} \&rhs, \mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} \&solution)
\begin{DoxyCompactList}\small\item\em General interface to solve function. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a2831faedac86c6e6acd34351c138fe52}{update}} (const unsigned \&k, const \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$$>$ \&H, const \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$ \&\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, const \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ \mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} $>$ \&v, \mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} \&x)
\begin{DoxyCompactList}\small\item\em Helper function to update the result vector using the result, x=x\+\_\+0+\+V\+\_\+m$\ast$y. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a74bb2d9ceab6473c1922b166ebf48681}{generate\+\_\+plane\+\_\+rotation}} (double \&dx, double \&dy, double \&cs, double \&sn)
\begin{DoxyCompactList}\small\item\em Helper function\+: Generate a plane rotation. This is done by finding the values of $ \cos(\theta) $ (i.\+e. cs) and \textbackslash{}sin(\textbackslash{}theta) (i.\+e. sn) such that\+: \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a175361cb4600f20511213636f2e645ce}{apply\+\_\+plane\+\_\+rotation}} (double \&dx, double \&dy, double \&cs, double \&sn)
\begin{DoxyCompactList}\small\item\em Helper function\+: Apply plane rotation. This is done using the update\+: \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
unsigned \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a9be7f8a66aefc1352e95741c5f265443}{Iterations}}
\begin{DoxyCompactList}\small\item\em Number of iterations taken. \end{DoxyCompactList}\item 
unsigned \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a472af506241c412c2a6fe4c53529118e}{Restart}}
\begin{DoxyCompactList}\small\item\em The number of iterations before the iteration proceedure is restarted if iteration restart is used. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a447c3077e0763deb70e7e9ac34748d74}{Iteration\+\_\+restart}}
\begin{DoxyCompactList}\small\item\em boolean indicating if iteration restarting is used \end{DoxyCompactList}\item 
\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} $\ast$ \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a2dd7330c78b780ccc87c0922656a72b2}{Matrix\+\_\+pt}}
\begin{DoxyCompactList}\small\item\em Pointer to matrix. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} $\ast$ \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_aaab9daf6e2eb2bae858f48027754a93e}{B\+\_\+pt}}
\begin{DoxyCompactList}\small\item\em Pointer to the column vector in the bordered system. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} $\ast$ \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a1f483fcae38f24ceda96c111333ebd2b}{C\+\_\+pt}}
\begin{DoxyCompactList}\small\item\em Pointer to the row vector in the bordered system. \end{DoxyCompactList}\item 
double $\ast$ \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a947a6617c3909fc2ffaebb9ebf001cfa}{X\+\_\+pt}}
\begin{DoxyCompactList}\small\item\em Pointer to the last entry of the LHS vector in the bordered system. \end{DoxyCompactList}\item 
double $\ast$ \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a5f7815e661ee9a79da7fdc485a8bc652}{Rhs\+\_\+pt}}
\begin{DoxyCompactList}\small\item\em Pointer to the last entry of the RHS vector in the bordered system. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a837e46fe93f07fa0740b5a7a9f40ebcb}{Schur\+\_\+complement\+\_\+scalar}}
\begin{DoxyCompactList}\small\item\em The scalar component of the Schur complement preconditioner. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a1c8bdfdfbba0518cf24ad56970186714}{Resolving}}
\begin{DoxyCompactList}\small\item\em Boolean flag to indicate if the solve is done in re-\/solve mode, bypassing setup of matrix and preconditioner. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_a9e906e80cad4f9261729e75f2448fc63}{Matrix\+\_\+can\+\_\+be\+\_\+deleted}}
\begin{DoxyCompactList}\small\item\em Boolean flag to indicate if the matrix pointed to be Matrix\+\_\+pt can be deleted. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES_ab32f761ac00fb98acfc66f07a62932c9}{Preconditioner\+\_\+\+LHS}}
\begin{DoxyCompactList}\small\item\em boolean indicating use of left hand preconditioning (if true) or right hand preconditioning (if false) \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
//////////////////////////////////////////////////////////////////// //////////////////////////////////////////////////////////////////// 

The \mbox{\hyperlink{classoomph_1_1GMRES}{GMRES}} method. 

Definition at line 1548 of file iterative\+\_\+linear\+\_\+solver.\+h.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a04987cc3a1440855435d2c26cfbfc0bf}\label{classoomph_1_1AugmentedProblemGMRES_a04987cc3a1440855435d2c26cfbfc0bf}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!AugmentedProblemGMRES@{AugmentedProblemGMRES}}
\index{AugmentedProblemGMRES@{AugmentedProblemGMRES}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{AugmentedProblemGMRES()}{AugmentedProblemGMRES()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily oomph\+::\+Augmented\+Problem\+GMRES\+::\+Augmented\+Problem\+GMRES (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} $\ast$}]{b\+\_\+pt,  }\item[{\mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} $\ast$}]{c\+\_\+pt,  }\item[{double $\ast$}]{x\+\_\+pt,  }\item[{double $\ast$}]{rhs\+\_\+pt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Constructor. 



Definition at line 1552 of file iterative\+\_\+linear\+\_\+solver.\+h.



References Iteration\+\_\+restart, and Preconditioner\+\_\+\+LHS.

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_ab2593fd534e6db559b93c1301306c69b}\label{classoomph_1_1AugmentedProblemGMRES_ab2593fd534e6db559b93c1301306c69b}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!````~AugmentedProblemGMRES@{$\sim$AugmentedProblemGMRES}}
\index{````~AugmentedProblemGMRES@{$\sim$AugmentedProblemGMRES}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{$\sim$AugmentedProblemGMRES()}{~AugmentedProblemGMRES()}}
{\footnotesize\ttfamily virtual oomph\+::\+Augmented\+Problem\+GMRES\+::$\sim$\+Augmented\+Problem\+GMRES (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Destructor\+: Clean up storage. 



Definition at line 1571 of file iterative\+\_\+linear\+\_\+solver.\+h.



References clean\+\_\+up\+\_\+memory().

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a5c19aa1ff1b23b8400f1e81b29f7e7de}\label{classoomph_1_1AugmentedProblemGMRES_a5c19aa1ff1b23b8400f1e81b29f7e7de}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!AugmentedProblemGMRES@{AugmentedProblemGMRES}}
\index{AugmentedProblemGMRES@{AugmentedProblemGMRES}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{AugmentedProblemGMRES()}{AugmentedProblemGMRES()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily oomph\+::\+Augmented\+Problem\+GMRES\+::\+Augmented\+Problem\+GMRES (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES}{Augmented\+Problem\+GMRES}} \&}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [delete]}}



Broken copy constructor. 



\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a175361cb4600f20511213636f2e645ce}\label{classoomph_1_1AugmentedProblemGMRES_a175361cb4600f20511213636f2e645ce}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!apply\_plane\_rotation@{apply\_plane\_rotation}}
\index{apply\_plane\_rotation@{apply\_plane\_rotation}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{apply\_plane\_rotation()}{apply\_plane\_rotation()}}
{\footnotesize\ttfamily void oomph\+::\+Augmented\+Problem\+GMRES\+::apply\+\_\+plane\+\_\+rotation (\begin{DoxyParamCaption}\item[{double \&}]{dx,  }\item[{double \&}]{dy,  }\item[{double \&}]{cs,  }\item[{double \&}]{sn }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Helper function\+: Apply plane rotation. This is done using the update\+: 

\[ \begin{bmatrix} dx \newline dy \end{bmatrix} \leftarrow \begin{bmatrix} \cos\theta & \sin\theta \newline -\sin\theta & \cos\theta \end{bmatrix} \begin{bmatrix} dx \newline dy \end{bmatrix}. \] 

Definition at line 1913 of file iterative\+\_\+linear\+\_\+solver.\+h.



Referenced by solve\+\_\+helper().

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a71199dc59da3f5077803829e36ad4aec}\label{classoomph_1_1AugmentedProblemGMRES_a71199dc59da3f5077803829e36ad4aec}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!apply\_schur\_complement\_preconditioner@{apply\_schur\_complement\_preconditioner}}
\index{apply\_schur\_complement\_preconditioner@{apply\_schur\_complement\_preconditioner}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{apply\_schur\_complement\_preconditioner()}{apply\_schur\_complement\_preconditioner()}}
{\footnotesize\ttfamily void oomph\+::\+Augmented\+Problem\+GMRES\+::apply\+\_\+schur\+\_\+complement\+\_\+preconditioner (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} \&}]{rhs,  }\item[{\mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} \&}]{soln }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Apply the block-\/diagonal Schur complement preconditioner to compute the LHS which has size N+1 (the augmented system size) 



Definition at line 1736 of file iterative\+\_\+linear\+\_\+solver.\+h.



References oomph\+::\+Distributable\+Linear\+Algebra\+Object\+::distribution\+\_\+pt(), i, oomph\+::\+Linear\+Algebra\+Distribution\+::nrow(), oomph\+::\+Iterative\+Linear\+Solver\+::preconditioner\+\_\+pt(), oomph\+::\+Preconditioner\+::preconditioner\+\_\+solve(), and Schur\+\_\+complement\+\_\+scalar.



Referenced by solve\+\_\+helper(), and update().

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a98bde93ede0909eb0170ef490c6d184d}\label{classoomph_1_1AugmentedProblemGMRES_a98bde93ede0909eb0170ef490c6d184d}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!augmented\_matrix\_multiply@{augmented\_matrix\_multiply}}
\index{augmented\_matrix\_multiply@{augmented\_matrix\_multiply}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{augmented\_matrix\_multiply()}{augmented\_matrix\_multiply()}}
{\footnotesize\ttfamily void oomph\+::\+Augmented\+Problem\+GMRES\+::augmented\+\_\+matrix\+\_\+multiply (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}} $\ast$}]{matrix\+\_\+pt,  }\item[{const \mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} \&}]{x,  }\item[{\mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} \&}]{soln }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Multiply the vector x by the augmented system matrix. 



Definition at line 1697 of file iterative\+\_\+linear\+\_\+solver.\+h.



References C\+\_\+pt, oomph\+::\+Distributable\+Linear\+Algebra\+Object\+::distribution\+\_\+pt(), oomph\+::\+Double\+Vector\+::dot(), i, oomph\+::\+CRDouble\+Matrix\+::multiply(), and oomph\+::\+CRDouble\+Matrix\+::nrow().



Referenced by solve\+\_\+helper().

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_aa4fbf2fd3d7ce466e7ea74620c4bdcea}\label{classoomph_1_1AugmentedProblemGMRES_aa4fbf2fd3d7ce466e7ea74620c4bdcea}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!clean\_up\_memory@{clean\_up\_memory}}
\index{clean\_up\_memory@{clean\_up\_memory}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{clean\_up\_memory()}{clean\_up\_memory()}}
{\footnotesize\ttfamily void oomph\+::\+Augmented\+Problem\+GMRES\+::clean\+\_\+up\+\_\+memory (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}, {\ttfamily [virtual]}}



Cleanup data that\textquotesingle{}s stored for resolve (if any has been stored) 



Reimplemented from \mbox{\hyperlink{classoomph_1_1LinearSolver_a9d66f3262e80ca06a365f98216afd85f}{oomph\+::\+Linear\+Solver}}.



Definition at line 1687 of file iterative\+\_\+linear\+\_\+solver.\+h.



References Matrix\+\_\+can\+\_\+be\+\_\+deleted, and Matrix\+\_\+pt.



Referenced by disable\+\_\+resolve(), solve(), and $\sim$\+Augmented\+Problem\+GMRES().

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a478992300f83afa08cde46ac11569986}\label{classoomph_1_1AugmentedProblemGMRES_a478992300f83afa08cde46ac11569986}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!disable\_iteration\_restart@{disable\_iteration\_restart}}
\index{disable\_iteration\_restart@{disable\_iteration\_restart}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{disable\_iteration\_restart()}{disable\_iteration\_restart()}}
{\footnotesize\ttfamily void oomph\+::\+Augmented\+Problem\+GMRES\+::disable\+\_\+iteration\+\_\+restart (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Switches off iteration restart. 



Definition at line 1668 of file iterative\+\_\+linear\+\_\+solver.\+h.



References Iteration\+\_\+restart.

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a338c1108f68089ba78104a93ec2cbbca}\label{classoomph_1_1AugmentedProblemGMRES_a338c1108f68089ba78104a93ec2cbbca}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!disable\_resolve@{disable\_resolve}}
\index{disable\_resolve@{disable\_resolve}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{disable\_resolve()}{disable\_resolve()}}
{\footnotesize\ttfamily void oomph\+::\+Augmented\+Problem\+GMRES\+::disable\+\_\+resolve (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Overload disable resolve so that it cleans up memory too. 



Reimplemented from \mbox{\hyperlink{classoomph_1_1LinearSolver_ad61c63af94c5961830bd9807225a48d6}{oomph\+::\+Linear\+Solver}}.



Definition at line 1583 of file iterative\+\_\+linear\+\_\+solver.\+h.



References clean\+\_\+up\+\_\+memory(), and oomph\+::\+Linear\+Solver\+::disable\+\_\+resolve().

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a7baee709b4066c7e3dce35afe76a0792}\label{classoomph_1_1AugmentedProblemGMRES_a7baee709b4066c7e3dce35afe76a0792}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!enable\_iteration\_restart@{enable\_iteration\_restart}}
\index{enable\_iteration\_restart@{enable\_iteration\_restart}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{enable\_iteration\_restart()}{enable\_iteration\_restart()}}
{\footnotesize\ttfamily void oomph\+::\+Augmented\+Problem\+GMRES\+::enable\+\_\+iteration\+\_\+restart (\begin{DoxyParamCaption}\item[{const unsigned \&}]{restart }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



switches on iteration restarting and takes as an argument the number of iterations after which the construction of the orthogonalisation basis vectors should be restarted 



Definition at line 1661 of file iterative\+\_\+linear\+\_\+solver.\+h.



References Iteration\+\_\+restart, and Restart.

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a74bb2d9ceab6473c1922b166ebf48681}\label{classoomph_1_1AugmentedProblemGMRES_a74bb2d9ceab6473c1922b166ebf48681}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!generate\_plane\_rotation@{generate\_plane\_rotation}}
\index{generate\_plane\_rotation@{generate\_plane\_rotation}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{generate\_plane\_rotation()}{generate\_plane\_rotation()}}
{\footnotesize\ttfamily void oomph\+::\+Augmented\+Problem\+GMRES\+::generate\+\_\+plane\+\_\+rotation (\begin{DoxyParamCaption}\item[{double \&}]{dx,  }\item[{double \&}]{dy,  }\item[{double \&}]{cs,  }\item[{double \&}]{sn }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Helper function\+: Generate a plane rotation. This is done by finding the values of $ \cos(\theta) $ (i.\+e. cs) and \textbackslash{}sin(\textbackslash{}theta) (i.\+e. sn) such that\+: 

\[ \begin{bmatrix} \cos\theta & \sin\theta \newline -\sin\theta & \cos\theta \end{bmatrix} \begin{bmatrix} dx \newline dy \end{bmatrix} = \begin{bmatrix} r \newline 0 \end{bmatrix}, \] where $ r=\sqrt{pow(dx,2)+pow(dy,2)} $. The values of a and b are given by\+: \[ \cos\theta=\dfrac{dx}{\sqrt{pow(dx,2)+pow(dy,2)}}, \] and \[ \sin\theta=\dfrac{dy}{\sqrt{pow(dx,2)+pow(dy,2)}}. \] Taken from\+: Saad Y.\char`\"{}\+Iterative methods for sparse linear systems\char`\"{}, p.\+192 

Definition at line 1868 of file iterative\+\_\+linear\+\_\+solver.\+h.



Referenced by solve\+\_\+helper().

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a5e3a50ebf6ce2d2c3a0a53b7e6f24300}\label{classoomph_1_1AugmentedProblemGMRES_a5e3a50ebf6ce2d2c3a0a53b7e6f24300}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!iteration\_restart@{iteration\_restart}}
\index{iteration\_restart@{iteration\_restart}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{iteration\_restart()}{iteration\_restart()}}
{\footnotesize\ttfamily bool oomph\+::\+Augmented\+Problem\+GMRES\+::iteration\+\_\+restart (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



access function indicating whether restarted \mbox{\hyperlink{classoomph_1_1GMRES}{GMRES}} is used 



Definition at line 1653 of file iterative\+\_\+linear\+\_\+solver.\+h.



References Iteration\+\_\+restart.

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a0e6fb26306985fc6bde851d372b78708}\label{classoomph_1_1AugmentedProblemGMRES_a0e6fb26306985fc6bde851d372b78708}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!iterations@{iterations}}
\index{iterations@{iterations}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{iterations()}{iterations()}}
{\footnotesize\ttfamily unsigned oomph\+::\+Augmented\+Problem\+GMRES\+::iterations (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Number of iterations taken. 



Implements \mbox{\hyperlink{classoomph_1_1IterativeLinearSolver_a5fe7f7b5e4847fdbd4f95d3875ec7a46}{oomph\+::\+Iterative\+Linear\+Solver}}.



Definition at line 1647 of file iterative\+\_\+linear\+\_\+solver.\+h.



References Iterations.

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_aa59dc0dfad8c26eeba778dde0cdc0d8d}\label{classoomph_1_1AugmentedProblemGMRES_aa59dc0dfad8c26eeba778dde0cdc0d8d}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!operator=@{operator=}}
\index{operator=@{operator=}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{operator=()}{operator=()}}
{\footnotesize\ttfamily void oomph\+::\+Augmented\+Problem\+GMRES\+::operator= (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classoomph_1_1AugmentedProblemGMRES}{Augmented\+Problem\+GMRES}} \&}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [delete]}}



Broken assignment operator. 

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a2a452417f612f30e3ae2a2701fa1e6de}\label{classoomph_1_1AugmentedProblemGMRES_a2a452417f612f30e3ae2a2701fa1e6de}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!resolve@{resolve}}
\index{resolve@{resolve}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{resolve()}{resolve()}}
{\footnotesize\ttfamily void oomph\+::\+Augmented\+Problem\+GMRES\+::resolve (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} \&}]{rhs,  }\item[{\mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} \&}]{result }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Re-\/solve the system defined by the last assembled Jacobian and the rhs vector specified here. Solution is returned in the vector result. 

\textbackslash{}\+Short Re-\/solve the system defined by the last assembled Jacobian and the rhs vector specified here. Solution is returned in the vector result. 

Reimplemented from \mbox{\hyperlink{classoomph_1_1LinearSolver_a3b310d08333033edc119b2a5bd7dcbfb}{oomph\+::\+Linear\+Solver}}.



Definition at line 2831 of file iterative\+\_\+linear\+\_\+solver.\+cc.



References Matrix\+\_\+pt, Resolving, and solve().

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_ae29f07a20c4e1290ae1c85f4c5756adc}\label{classoomph_1_1AugmentedProblemGMRES_ae29f07a20c4e1290ae1c85f4c5756adc}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!set\_preconditioner\_LHS@{set\_preconditioner\_LHS}}
\index{set\_preconditioner\_LHS@{set\_preconditioner\_LHS}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{set\_preconditioner\_LHS()}{set\_preconditioner\_LHS()}}
{\footnotesize\ttfamily void oomph\+::\+Augmented\+Problem\+GMRES\+::set\+\_\+preconditioner\+\_\+\+LHS (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set left preconditioning (the default) 



Definition at line 1674 of file iterative\+\_\+linear\+\_\+solver.\+h.



References Preconditioner\+\_\+\+LHS.

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_ab9349ea974f4e84d4ae3d7de096e60bd}\label{classoomph_1_1AugmentedProblemGMRES_ab9349ea974f4e84d4ae3d7de096e60bd}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!set\_preconditioner\_RHS@{set\_preconditioner\_RHS}}
\index{set\_preconditioner\_RHS@{set\_preconditioner\_RHS}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{set\_preconditioner\_RHS()}{set\_preconditioner\_RHS()}}
{\footnotesize\ttfamily void oomph\+::\+Augmented\+Problem\+GMRES\+::set\+\_\+preconditioner\+\_\+\+RHS (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Enable right preconditioning. 



Definition at line 1680 of file iterative\+\_\+linear\+\_\+solver.\+h.



References Preconditioner\+\_\+\+LHS.

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a0e7809509296cc1b6d355a7e02d0f989}\label{classoomph_1_1AugmentedProblemGMRES_a0e7809509296cc1b6d355a7e02d0f989}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!solve@{solve}}
\index{solve@{solve}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{solve()}{solve()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily void oomph\+::\+Augmented\+Problem\+GMRES\+::solve (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase}{Double\+Matrix\+Base}} $\ast$const \&}]{matrix\+\_\+pt,  }\item[{const \mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} \&}]{rhs,  }\item[{\mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} \&}]{solution }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Linear-\/algebra-\/type solver\+: Takes pointer to a matrix and rhs vector and returns the solution of the linear system. 



Reimplemented from \mbox{\hyperlink{classoomph_1_1LinearSolver_a546c09822d18191df14caed864c04c09}{oomph\+::\+Linear\+Solver}}.



Definition at line 1596 of file iterative\+\_\+linear\+\_\+solver.\+h.



References oomph\+::\+Distributable\+Linear\+Algebra\+Object\+::build\+\_\+distribution(), oomph\+::\+Distributable\+Linear\+Algebra\+Object\+::distribution\+\_\+pt(), oomph\+::\+Linear\+Solver\+::\+Enable\+\_\+resolve, Matrix\+\_\+can\+\_\+be\+\_\+deleted, Matrix\+\_\+pt, Resolving, and solve\+\_\+helper().

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a6dc70380e15f0c35f3d4e1d3dc827c97}\label{classoomph_1_1AugmentedProblemGMRES_a6dc70380e15f0c35f3d4e1d3dc827c97}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!solve@{solve}}
\index{solve@{solve}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{solve()}{solve()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily void oomph\+::\+Augmented\+Problem\+GMRES\+::solve (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase}{Double\+Matrix\+Base}} $\ast$const \&}]{matrix\+\_\+pt,  }\item[{const \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$ \&}]{rhs,  }\item[{\mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$ \&}]{result }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Linear-\/algebra-\/type solver\+: Takes pointer to a matrix and rhs vector and returns the solution of the linear system Call the broken base-\/class version. If you want this, please implement it. 



Reimplemented from \mbox{\hyperlink{classoomph_1_1LinearSolver_a1f7a2ee2cd18d3dafc20a61ca2f52dbb}{oomph\+::\+Linear\+Solver}}.



Definition at line 1634 of file iterative\+\_\+linear\+\_\+solver.\+h.



References oomph\+::\+Linear\+Solver\+::solve().

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a73d8d3d8b161084e6291560cdd7984dc}\label{classoomph_1_1AugmentedProblemGMRES_a73d8d3d8b161084e6291560cdd7984dc}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!solve@{solve}}
\index{solve@{solve}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{solve()}{solve()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily void oomph\+::\+Augmented\+Problem\+GMRES\+::solve (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classoomph_1_1Problem}{Problem}} $\ast$const \&}]{problem\+\_\+pt,  }\item[{\mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} \&}]{result }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Solver\+: Takes pointer to problem and returns the results vector which contains the solution of the linear system defined by the problem\textquotesingle{}s fully assembled Jacobian and residual vector. 

//////////////////////////////////////////////////////////////////// ////////////////////////////////////////////////////////////////////

Solver\+: Takes pointer to problem and returns the results vector which contains the solution of the linear system defined by the problem\textquotesingle{}s fully assembled Jacobian and residual vector. 

Implements \mbox{\hyperlink{classoomph_1_1LinearSolver_a15ce22542b74ed1826ea485edacbeb6e}{oomph\+::\+Linear\+Solver}}.



Definition at line 2746 of file iterative\+\_\+linear\+\_\+solver.\+cc.



References oomph\+::\+Double\+Vector\+::build(), oomph\+::\+Distributable\+Linear\+Algebra\+Object\+::build\+\_\+distribution(), oomph\+::\+Double\+Vector\+::built(), clean\+\_\+up\+\_\+memory(), oomph\+::\+Problem\+::communicator\+\_\+pt(), oomph\+::\+Distributable\+Linear\+Algebra\+Object\+::distribution\+\_\+pt(), oomph\+::\+Linear\+Solver\+::\+Doc\+\_\+time, oomph\+::\+Linear\+Solver\+::\+Enable\+\_\+resolve, oomph\+::\+Problem\+::get\+\_\+jacobian(), oomph\+::\+Iterative\+Linear\+Solver\+::\+Jacobian\+\_\+setup\+\_\+time, Matrix\+\_\+can\+\_\+be\+\_\+deleted, Matrix\+\_\+pt, oomph\+::\+Problem\+::ndof(), oomph\+::oomph\+\_\+info, oomph\+::\+Double\+Vector\+::redistribute(), Resolving, Schur\+\_\+complement\+\_\+scalar, solve\+\_\+helper(), and oomph\+::\+Timing\+Helpers\+::timer().



Referenced by resolve().

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a1ff5a4b43235b43d2254af0db6195dc7}\label{classoomph_1_1AugmentedProblemGMRES_a1ff5a4b43235b43d2254af0db6195dc7}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!solve\_helper@{solve\_helper}}
\index{solve\_helper@{solve\_helper}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{solve\_helper()}{solve\_helper()}}
{\footnotesize\ttfamily void oomph\+::\+Augmented\+Problem\+GMRES\+::solve\+\_\+helper (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase}{Double\+Matrix\+Base}} $\ast$const \&}]{matrix\+\_\+pt,  }\item[{const \mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} \&}]{rhs,  }\item[{\mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} \&}]{solution }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



General interface to solve function. 

Linear-\/algebra-\/type solver\+: Takes pointer to a matrix and rhs vector and returns the solution of the linear system. based on the algorithm presented in Templates for the Solution of Linear Systems\+: Building Blocks for Iterative Methods, Barrett, Berry et al, SIAM, 2006 and the implementation in the IML++ library \+: \href{http://math.nist.gov/iml++/}{\texttt{ http\+://math.\+nist.\+gov/iml++/}}. 

Definition at line 2862 of file iterative\+\_\+linear\+\_\+solver.\+cc.



References apply\+\_\+plane\+\_\+rotation(), apply\+\_\+schur\+\_\+complement\+\_\+preconditioner(), augmented\+\_\+matrix\+\_\+multiply(), B\+\_\+pt, oomph\+::\+Double\+Vector\+::build(), oomph\+::\+Double\+Vector\+::built(), C\+\_\+pt, oomph\+::\+Linear\+Algebra\+Distribution\+::communicator\+\_\+pt(), oomph\+::\+Linear\+Algebra\+Distribution\+::distributed(), oomph\+::\+Distributable\+Linear\+Algebra\+Object\+::distributed(), oomph\+::\+Distributable\+Linear\+Algebra\+Object\+::distribution\+\_\+pt(), oomph\+::\+Iterative\+Linear\+Solver\+::\+Doc\+\_\+convergence\+\_\+history, oomph\+::\+Linear\+Solver\+::\+Doc\+\_\+time, oomph\+::\+Double\+Vector\+::dot(), generate\+\_\+plane\+\_\+rotation(), i, oomph\+::\+Double\+Vector\+::initialise(), Iteration\+\_\+restart, Iterations, oomph\+::\+Iterative\+Linear\+Solver\+::\+Max\+\_\+iter, oomph\+::\+Double\+Vector\+::norm(), oomph\+::\+Distributable\+Linear\+Algebra\+Object\+::nrow(), oomph\+::\+Double\+Matrix\+Base\+::nrow(), oomph\+::oomph\+\_\+info, oomph\+::\+Iterative\+Linear\+Solver\+::\+Output\+\_\+file\+\_\+stream, Preconditioner\+\_\+\+LHS, oomph\+::\+Iterative\+Linear\+Solver\+::preconditioner\+\_\+pt(), oomph\+::\+Iterative\+Linear\+Solver\+::\+Preconditioner\+\_\+setup\+\_\+time, oomph\+::\+Preconditioner\+::preconditioner\+\_\+solve(), Resolving, Restart, s, Schur\+\_\+complement\+\_\+scalar, oomph\+::\+Preconditioner\+::setup(), oomph\+::\+Iterative\+Linear\+Solver\+::\+Setup\+\_\+preconditioner\+\_\+before\+\_\+solve, oomph\+::\+Iterative\+Linear\+Solver\+::\+Solution\+\_\+time, oomph\+::\+Global\+\_\+string\+\_\+for\+\_\+annotation\+::string(), oomph\+::\+Iterative\+Linear\+Solver\+::\+Throw\+\_\+error\+\_\+after\+\_\+max\+\_\+iter, oomph\+::\+Timing\+Helpers\+::timer(), oomph\+::\+Iterative\+Linear\+Solver\+::\+Tolerance, update(), and oomph\+::\+Double\+Vector\+::values\+\_\+pt().



Referenced by solve().

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a2831faedac86c6e6acd34351c138fe52}\label{classoomph_1_1AugmentedProblemGMRES_a2831faedac86c6e6acd34351c138fe52}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!update@{update}}
\index{update@{update}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{update()}{update()}}
{\footnotesize\ttfamily void oomph\+::\+Augmented\+Problem\+GMRES\+::update (\begin{DoxyParamCaption}\item[{const unsigned \&}]{k,  }\item[{const \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$$>$ \&}]{H,  }\item[{const \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ double $>$ \&}]{s,  }\item[{const \mbox{\hyperlink{classoomph_1_1Vector}{Vector}}$<$ \mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} $>$ \&}]{v,  }\item[{\mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}} \&}]{x }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Helper function to update the result vector using the result, x=x\+\_\+0+\+V\+\_\+m$\ast$y. 



Definition at line 1790 of file iterative\+\_\+linear\+\_\+solver.\+h.



References apply\+\_\+schur\+\_\+complement\+\_\+preconditioner(), oomph\+::\+Distributable\+Linear\+Algebra\+Object\+::distribution\+\_\+pt(), i, oomph\+::\+Distributable\+Linear\+Algebra\+Object\+::nrow(), Preconditioner\+\_\+\+LHS, s, and oomph\+::\+Double\+Vector\+::values\+\_\+pt().



Referenced by solve\+\_\+helper().



\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_aaab9daf6e2eb2bae858f48027754a93e}\label{classoomph_1_1AugmentedProblemGMRES_aaab9daf6e2eb2bae858f48027754a93e}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!B\_pt@{B\_pt}}
\index{B\_pt@{B\_pt}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{B\_pt}{B\_pt}}
{\footnotesize\ttfamily \mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}}$\ast$ oomph\+::\+Augmented\+Problem\+GMRES\+::\+B\+\_\+pt\hspace{0.3cm}{\ttfamily [private]}}



Pointer to the column vector in the bordered system. 



Definition at line 1939 of file iterative\+\_\+linear\+\_\+solver.\+h.



Referenced by solve\+\_\+helper().

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a1f483fcae38f24ceda96c111333ebd2b}\label{classoomph_1_1AugmentedProblemGMRES_a1f483fcae38f24ceda96c111333ebd2b}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!C\_pt@{C\_pt}}
\index{C\_pt@{C\_pt}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{C\_pt}{C\_pt}}
{\footnotesize\ttfamily \mbox{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector}}$\ast$ oomph\+::\+Augmented\+Problem\+GMRES\+::\+C\+\_\+pt\hspace{0.3cm}{\ttfamily [private]}}



Pointer to the row vector in the bordered system. 



Definition at line 1942 of file iterative\+\_\+linear\+\_\+solver.\+h.



Referenced by augmented\+\_\+matrix\+\_\+multiply(), and solve\+\_\+helper().

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a447c3077e0763deb70e7e9ac34748d74}\label{classoomph_1_1AugmentedProblemGMRES_a447c3077e0763deb70e7e9ac34748d74}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!Iteration\_restart@{Iteration\_restart}}
\index{Iteration\_restart@{Iteration\_restart}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{Iteration\_restart}{Iteration\_restart}}
{\footnotesize\ttfamily bool oomph\+::\+Augmented\+Problem\+GMRES\+::\+Iteration\+\_\+restart\hspace{0.3cm}{\ttfamily [private]}}



boolean indicating if iteration restarting is used 



Definition at line 1933 of file iterative\+\_\+linear\+\_\+solver.\+h.



Referenced by Augmented\+Problem\+GMRES(), disable\+\_\+iteration\+\_\+restart(), enable\+\_\+iteration\+\_\+restart(), iteration\+\_\+restart(), and solve\+\_\+helper().

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a9be7f8a66aefc1352e95741c5f265443}\label{classoomph_1_1AugmentedProblemGMRES_a9be7f8a66aefc1352e95741c5f265443}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!Iterations@{Iterations}}
\index{Iterations@{Iterations}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{Iterations}{Iterations}}
{\footnotesize\ttfamily unsigned oomph\+::\+Augmented\+Problem\+GMRES\+::\+Iterations\hspace{0.3cm}{\ttfamily [private]}}



Number of iterations taken. 



Definition at line 1926 of file iterative\+\_\+linear\+\_\+solver.\+h.



Referenced by iterations(), and solve\+\_\+helper().

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a9e906e80cad4f9261729e75f2448fc63}\label{classoomph_1_1AugmentedProblemGMRES_a9e906e80cad4f9261729e75f2448fc63}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!Matrix\_can\_be\_deleted@{Matrix\_can\_be\_deleted}}
\index{Matrix\_can\_be\_deleted@{Matrix\_can\_be\_deleted}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{Matrix\_can\_be\_deleted}{Matrix\_can\_be\_deleted}}
{\footnotesize\ttfamily bool oomph\+::\+Augmented\+Problem\+GMRES\+::\+Matrix\+\_\+can\+\_\+be\+\_\+deleted\hspace{0.3cm}{\ttfamily [private]}}



Boolean flag to indicate if the matrix pointed to be Matrix\+\_\+pt can be deleted. 



Definition at line 1959 of file iterative\+\_\+linear\+\_\+solver.\+h.



Referenced by clean\+\_\+up\+\_\+memory(), and solve().

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a2dd7330c78b780ccc87c0922656a72b2}\label{classoomph_1_1AugmentedProblemGMRES_a2dd7330c78b780ccc87c0922656a72b2}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!Matrix\_pt@{Matrix\_pt}}
\index{Matrix\_pt@{Matrix\_pt}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{Matrix\_pt}{Matrix\_pt}}
{\footnotesize\ttfamily \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDouble\+Matrix}}$\ast$ oomph\+::\+Augmented\+Problem\+GMRES\+::\+Matrix\+\_\+pt\hspace{0.3cm}{\ttfamily [private]}}



Pointer to matrix. 



Definition at line 1936 of file iterative\+\_\+linear\+\_\+solver.\+h.



Referenced by clean\+\_\+up\+\_\+memory(), resolve(), and solve().

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_ab32f761ac00fb98acfc66f07a62932c9}\label{classoomph_1_1AugmentedProblemGMRES_ab32f761ac00fb98acfc66f07a62932c9}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!Preconditioner\_LHS@{Preconditioner\_LHS}}
\index{Preconditioner\_LHS@{Preconditioner\_LHS}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{Preconditioner\_LHS}{Preconditioner\_LHS}}
{\footnotesize\ttfamily bool oomph\+::\+Augmented\+Problem\+GMRES\+::\+Preconditioner\+\_\+\+LHS\hspace{0.3cm}{\ttfamily [private]}}



boolean indicating use of left hand preconditioning (if true) or right hand preconditioning (if false) 



Definition at line 1963 of file iterative\+\_\+linear\+\_\+solver.\+h.



Referenced by Augmented\+Problem\+GMRES(), set\+\_\+preconditioner\+\_\+\+LHS(), set\+\_\+preconditioner\+\_\+\+RHS(), solve\+\_\+helper(), and update().

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a1c8bdfdfbba0518cf24ad56970186714}\label{classoomph_1_1AugmentedProblemGMRES_a1c8bdfdfbba0518cf24ad56970186714}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!Resolving@{Resolving}}
\index{Resolving@{Resolving}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{Resolving}{Resolving}}
{\footnotesize\ttfamily bool oomph\+::\+Augmented\+Problem\+GMRES\+::\+Resolving\hspace{0.3cm}{\ttfamily [private]}}



Boolean flag to indicate if the solve is done in re-\/solve mode, bypassing setup of matrix and preconditioner. 



Definition at line 1955 of file iterative\+\_\+linear\+\_\+solver.\+h.



Referenced by resolve(), solve(), and solve\+\_\+helper().

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a472af506241c412c2a6fe4c53529118e}\label{classoomph_1_1AugmentedProblemGMRES_a472af506241c412c2a6fe4c53529118e}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!Restart@{Restart}}
\index{Restart@{Restart}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{Restart}{Restart}}
{\footnotesize\ttfamily unsigned oomph\+::\+Augmented\+Problem\+GMRES\+::\+Restart\hspace{0.3cm}{\ttfamily [private]}}



The number of iterations before the iteration proceedure is restarted if iteration restart is used. 



Definition at line 1930 of file iterative\+\_\+linear\+\_\+solver.\+h.



Referenced by enable\+\_\+iteration\+\_\+restart(), and solve\+\_\+helper().

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a5f7815e661ee9a79da7fdc485a8bc652}\label{classoomph_1_1AugmentedProblemGMRES_a5f7815e661ee9a79da7fdc485a8bc652}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!Rhs\_pt@{Rhs\_pt}}
\index{Rhs\_pt@{Rhs\_pt}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{Rhs\_pt}{Rhs\_pt}}
{\footnotesize\ttfamily double$\ast$ oomph\+::\+Augmented\+Problem\+GMRES\+::\+Rhs\+\_\+pt\hspace{0.3cm}{\ttfamily [private]}}



Pointer to the last entry of the RHS vector in the bordered system. 



Definition at line 1948 of file iterative\+\_\+linear\+\_\+solver.\+h.

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a837e46fe93f07fa0740b5a7a9f40ebcb}\label{classoomph_1_1AugmentedProblemGMRES_a837e46fe93f07fa0740b5a7a9f40ebcb}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!Schur\_complement\_scalar@{Schur\_complement\_scalar}}
\index{Schur\_complement\_scalar@{Schur\_complement\_scalar}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{Schur\_complement\_scalar}{Schur\_complement\_scalar}}
{\footnotesize\ttfamily double oomph\+::\+Augmented\+Problem\+GMRES\+::\+Schur\+\_\+complement\+\_\+scalar\hspace{0.3cm}{\ttfamily [private]}}



The scalar component of the Schur complement preconditioner. 



Definition at line 1951 of file iterative\+\_\+linear\+\_\+solver.\+h.



Referenced by apply\+\_\+schur\+\_\+complement\+\_\+preconditioner(), solve(), and solve\+\_\+helper().

\mbox{\Hypertarget{classoomph_1_1AugmentedProblemGMRES_a947a6617c3909fc2ffaebb9ebf001cfa}\label{classoomph_1_1AugmentedProblemGMRES_a947a6617c3909fc2ffaebb9ebf001cfa}} 
\index{oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}!X\_pt@{X\_pt}}
\index{X\_pt@{X\_pt}!oomph::AugmentedProblemGMRES@{oomph::AugmentedProblemGMRES}}
\doxysubsubsection{\texorpdfstring{X\_pt}{X\_pt}}
{\footnotesize\ttfamily double$\ast$ oomph\+::\+Augmented\+Problem\+GMRES\+::\+X\+\_\+pt\hspace{0.3cm}{\ttfamily [private]}}



Pointer to the last entry of the LHS vector in the bordered system. 



Definition at line 1945 of file iterative\+\_\+linear\+\_\+solver.\+h.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{iterative__linear__solver_8h}{iterative\+\_\+linear\+\_\+solver.\+h}}\item 
\mbox{\hyperlink{iterative__linear__solver_8cc}{iterative\+\_\+linear\+\_\+solver.\+cc}}\end{DoxyCompactItemize}
